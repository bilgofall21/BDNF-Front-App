<app-header></app-header>
<div class="allContainer">
  <div class="banner mt-5">
    <img class="img-fluid" src="/assets/image/ralisation.png" alt="">
  </div>


  <section class="ftco-section ftco-project" id="projects-section">
    <div class="container-fluid px-md-4">
      <div class="row mt-4">
        <div class="col-lg-8 offset-lg-2 text-center">
          <div class="section-title">
            <h3><span class="orange-text">Nos</span> Realisations</h3>
            <p>Jetez un ≈ìil √† nos projets r√©cents et voyez comment nous avons aid√© nos clients √† r√©ussir.</p>
          </div>
        </div>
      </div>

      <div class="searchbar mb-5">
        <div class="d-flex justify-content-end">
          <div class="input-group " id="mysearch">
            <input type="search" class="form-control rounded" placeholder="Rechercher" aria-label="Search"
              aria-describedby="search-addon" [(ngModel)]="searchRealisation" (input)="getArticlesPage()"   />
            </div>
            <span class="input-group-text" id="search-addon">
              <i class="bi bi-search"></i>
            </span>
        </div>
      </div>
      <div class="container">



        @if (!loadingData) {
        <section class="ftco-section ftco-project" id="projects-section">
          <div class="container">

            <!-- <div class="row">
              <div class="col-lg-8 offset-lg-2 text-center">
                <div class="section-title">
                  <h3><span class="orange-text">Nos</span> Realisations</h3>
                  <p>Jetez un ≈ìil √† nos projets r√©cents et voyez comment nous avons aid√© nos clients √† r√©ussir.</p>
                </div>
              </div>
            </div> -->

            <div class="row mb-5 link-blog">
              <div class="col-md-6">
                <h4 class="section-title">Nos r√©centes r√©alisations</h4>
              </div>
              <div class="col-md-6 text-start text-md-end">
                <!-- <a class="text-decoration-none boxed-btn" [routerLink]="['/realisation-user']">
                  Voir toutes les r√©alisations
                  <i class="bi bi-arrow-right-circle ms-2"></i>
                </a> -->
              </div>
            </div>

            <div class="row">
              @if (getArticlesPage() && getArticlesPage().length > 0) {
              @for (realisa of getArticlesPage(); track realisa) {
              <div class="col-lg-4 col-md-6 mb-4">
                <div class="single-latest-news">

                  <!-- Container pour l'image ou le PDF -->
                  <div class="latest-news-bg-container position-relative">
                    @if (isPdf(realisa)) {
                    <!-- Aper√ßu PDF avec overlay cliquable -->
                    <div class="latest-news-bg pdf-preview-card" [ngStyle]="getBackgroundStyle(realisa)"
                      style="cursor: pointer;">
                      <div class="pdf-overlay-content text-center text-white">
                        <i class="bi bi-file-pdf-fill" style="font-size: 4rem;"></i>
                        <p class="mt-3 mb-0 fw-bold">Document PDF</p>
                        <small>Cliquez pour consulter</small>
                      </div>
                      <!-- Badge PDF -->
                      <span class="badge bg-danger position-absolute top-0 end-0 m-3 shadow">
                        <i class="bi bi-file-earmark-pdf"></i> PDF
                      </span>

                      <!-- Boutons d'action rapide pour PDF -->
                      <div
                        class="pdf-quick-actions position-absolute bottom-0 start-0 end-0 p-3 d-flex gap-2 justify-content-center">
                        <button class="btn btn-sm btn-light shadow-sm"
                          (click)="openPdfInNewTab(realisa); $event.stopPropagation()" title="Ouvrir dans un nouvel onglet">
                          <i class="bi bi-box-arrow-up-right"></i>
                        </button>
                        <button class="btn btn-sm btn-light shadow-sm" (click)="downloadPdf(realisa); $event.stopPropagation()"
                          title="T√©l√©charger">
                          <i class="bi bi-download"></i>
                        </button>
                        <button class="btn btn-sm btn-primary shadow-sm" [routerLink]="['/detail-realisation', realisa.uuid]"
                          (click)="$event.stopPropagation()" title="Voir les d√©tails">
                          <i class="bi bi-eye"></i>
                        </button>
                      </div>
                    </div>
                    } @else {
                    <!-- Image classique -->
                    <a [routerLink]="['/detail-realisation', realisa.uuid]">
                      <div class="latest-news-bg news-bg-1"
                        [ngStyle]="{'background-image': 'url(' + getRealisationImage(realisa) + ')'}">
                      </div>
                    </a>
                    }
                  </div>

                  <div class="news-text-box">
                    <h3>
                      <a class="text-decoration-none" [routerLink]="['/detail-realisation', realisa.uuid]">
                        {{realisa.titre}}
                      </a>
                    </h3>
                    <p class="blog-meta">
                      <span class="date">
                        <i class="fas fa-calendar"></i>
                        {{realisa.created_at | dateFormat}}
                      </span>
                      @if (isPdf(realisa)) {
                      <span class="ms-3 text-muted">
                        <i class="bi bi-file-pdf text-danger"></i>
                        Document PDF
                      </span>
                      }
                    </p>
                    <p class="excerpt">{{realisa.description | paragraph: 150}}</p>
                  </div>

                  <div class="news-footer">
                    <a [routerLink]="['/detail-realisation', realisa.uuid]" class="read-more-btn text-decoration-none">
                      voir plus
                      <i class="bi bi-arrow-right-circle ms-2"></i>
                    </a>
                  </div>

                </div>
              </div>
              }
              } @else {
              <p class="text-center my-4">Aucune r√©alisation disponible pour le moment üòí.</p>
              }
            </div>
          </div>
        </section>

        <!-- Modal pour visualiser les PDFs -->
        <div class="modal fade" id="pdfViewerModal" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
              <div class="modal-header bg-dark text-white">
                <h5 class="modal-title">
                  <i class="bi bi-file-pdf-fill text-danger me-2"></i>
                  {{selectedPdfTitle}}
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"
                  (click)="closePdfViewer()"></button>
              </div>
              <div class="modal-body p-0" style="min-height: 600px;">
                @if (safePdfUrl) {
                <iframe [src]="safePdfUrl" width="100%" height="600px" style="border: none;" title="Visualisateur PDF">
                </iframe>
                }
              </div>
              <div class="modal-footer">
                <a [href]="currentPdfUrl" target="_blank" class="btn btn-primary">
                  <i class="bi bi-box-arrow-up-right me-2"></i>
                  Ouvrir dans un nouvel onglet
                </a>
                <a [href]="currentPdfUrl" download class="btn btn-success">
                  <i class="bi bi-download me-2"></i>
                  T√©l√©charger
                </a>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" (click)="closePdfViewer()">
                  Fermer
                </button>
              </div>
            </div>
          </div>
        </div>
        }
        <div class="d-flex flex-wrap justify-content-center my-5 ms-5 " id="pagination">
          <nav aria-label="Page navigation example">
            <ul class="pagination">
              <li class="page-item  "><button class="paginate"  [disabled]="pageActuelle === 1" (click)="pageActuelle = pageActuelle - 1"  >Pr√©c√©dent</button></li>
              <li class="page-item"><button class="paginatee" *ngFor="let page of pages" [class.current]="page === pageActuelle"
                (click)="pageActuelle = page"> {{ page }}</button></li>
              <li class="page-item"><button class="paginat"  [disabled]="pageActuelle === totalPages"
                (click)="pageActuelle = pageActuelle + 1">Suivant</button></li>
            </ul>
          </nav>
      </div>
      </div>
    </div>
  </section>
  </div>

<app-footer></app-footer>
